<!-- Train City Selector Modal -->
<div data-train-city-selector-target="modal" class="hidden fixed inset-0 z-50 overflow-hidden">
  <!-- Backdrop -->
  <div class="absolute inset-0 bg-black bg-opacity-50" data-action="click->train-city-selector#closeModal"></div>
  
  <!-- Modal Content -->
  <div class="absolute inset-0 flex items-end justify-center">
    <div class="bg-white w-full max-w-md mx-auto h-[92vh] rounded-t-3xl flex flex-col overflow-hidden">
      
      <!-- 顶部固定区域 -->
      <div class="px-4 pt-4 pb-2 bg-white z-20 shrink-0">
        <!-- 顶部切换和关闭按钮 -->
        <div class="flex justify-between items-center mb-4 relative">
          <div class="flex-1 flex justify-center">
            <div class="bg-gray-100 p-1 rounded-sm flex text-sm font-medium">
              <button 
                class="bg-white shadow-sm px-4 py-1.5 rounded-sm text-gray-900">
                <span data-modal-title>单选出发地</span>
              </button>
            </div>
          </div>
          <button 
            data-action="click->train-city-selector#closeModal"
            class="absolute right-0 p-1">
            <svg class="h-6 w-6 text-gray-800" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>

        <!-- 搜索框 -->
        <div class="flex items-center gap-2 mb-4">
          <div class="flex-1 bg-gray-100 rounded-xl px-3 py-2.5 flex items-center">
            <svg class="h-5 w-5 text-gray-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
            <input 
              type="text"
              data-train-city-selector-target="searchInput"
              data-action="input->train-city-selector#search"
              placeholder="搜索城市中英文或拼音"
              class="flex-1 bg-transparent text-sm text-gray-900 placeholder-gray-400 focus:outline-none">
          </div>
        </div>

        <!-- 国内/国际 Tab -->
        <div class="w-full flex items-center text-base font-medium border-b border-gray-100">
          <button 
            data-train-city-selector-target="tabDeparture"
            data-action="click->train-city-selector#showDomestic"
            class="flex-1 py-2 text-gray-900 relative">
            <span>国内</span>
            <div class="absolute bottom-0 left-1/2 -translate-x-1/2 w-8 h-0.5 bg-black"></div>
          </button>
          <button 
            data-train-city-selector-target="tabDestination"
            data-action="click->train-city-selector#showInternational"
            class="flex-1 py-2 text-gray-500 relative">
            <span>国际/中国港澳台</span>
            <div class="hidden absolute bottom-0 left-1/2 -translate-x-1/2 w-8 h-0.5 bg-black"></div>
          </button>
        </div>
      </div>

      <!-- 下方主体内容区 -->
      <div class="flex flex-1 overflow-hidden relative">
        
        <!-- 国内标签内容 -->
        <div data-train-city-selector-target="domesticList" class="flex w-full flex-col overflow-y-auto">
          <!-- Current/History Section -->
          <div data-train-city-selector-target="historySection" class="px-4 py-4 border-b border-gray-100">
            <div class="text-sm font-medium text-gray-500 mb-3">当前/历史</div>
            <div data-train-city-selector-target="currentCity" class="text-sm text-gray-400">
              暂无历史记录
            </div>
          </div>
          
          <!-- Hot Cities -->
          <div class="px-4 py-4 border-b border-gray-100">
            <div class="flex items-center justify-between mb-3">
              <div class="text-sm font-medium text-gray-900">热门城市</div>
            </div>
            
            <div class="grid grid-cols-4 gap-3">
              <% [{name: "北京", pinyin: "beijing"}, {name: "上海", pinyin: "shanghai"}, {name: "广州", pinyin: "guangzhou"}, {name: "杭州", pinyin: "hangzhou"}, {name: "成都", pinyin: "chengdu"}, {name: "深圳", pinyin: "shenzhen"}, {name: "重庆", pinyin: "chongqing"}, {name: "西安", pinyin: "xian"}, {name: "郑州", pinyin: "zhengzhou"}, {name: "昆明", pinyin: "kunming"}, {name: "哈尔滨", pinyin: "haerbin"}, {name: "南京", pinyin: "nanjing"}, {name: "武汉", pinyin: "wuhan"}, {name: "沈阳", pinyin: "shenyang"}, {name: "海口", pinyin: "haikou"}, {name: "长沙", pinyin: "changsha"}].each do |city| %>
                <button 
                  data-action="click->train-city-selector#selectCity"
                  data-city-name="<%= city[:name] %>"
                  data-city-pinyin="<%= city[:pinyin] %>"
                  class="py-2 text-center text-sm rounded hover:bg-gray-100 transition-colors">
                  <%= city[:name] %>
                </button>
              <% end %>
            </div>
          </div>
          
          <!-- Letter Index -->
          <div class="px-4 py-3 border-b border-gray-100">
            <div class="text-sm font-medium text-gray-900 mb-3">字母索引</div>
            <div class="grid grid-cols-7 gap-2">
              <% ('A'..'Z').each do |letter| %>
                <button 
                  data-action="click->train-city-selector#jumpToLetter"
                  data-letter="<%= letter %>"
                  class="py-2 text-center text-sm text-gray-600 hover:bg-gray-100 rounded transition-colors">
                  <%= letter %>
                </button>
              <% end %>
            </div>
          </div>
          
          <!-- Cities by Letter -->
          <div class="px-4 py-4">
            <% # Chinese cities grouped by pinyin first letter %>
            <% cities_data = [
              ['A', ['安庆', '鞍山', '安阳', '安康']],
              ['B', ['北京', '包头', '保定', '蚌埠', '宝鸡']],
              ['C', ['成都', '长春', '长沙', '常州', '重庆', '沈阳']],
              ['D', ['大连', '东莞', '大同', '丹东', '大庆']],
              ['F', ['福州', '佛山', '抚顺', '抚州']],
              ['G', ['广州', '贵阳', '桂林', '赣州']],
              ['H', ['杭州', '哈尔滨', '合肥', '海口', '呼和浩特', '邯郸', '惠州']],
              ['J', ['济南', '济宁', '吉林', '江门', '九江', '嘉兴']],
              ['K', ['昆明', '开封']],
              ['L', ['兰州', '洛阳', '临沂', '柳州', '连云港', '廊坊']],
              ['N', ['南京', '南昌', '南宁', '宁波', '南通']],
              ['Q', ['青岛', '秦皇岛', '泉州', '衢州']],
              ['S', ['上海', '深圳', '沈阳', '石家庄', '苏州', '汕头', '绍兴']],
              ['T', ['天津', '太原', '唐山', '台州', '泰安']],
              ['W', ['武汉', '乌鲁木齐', '无锡', '威海', '潍坊', '温州', '芜湖']],
              ['X', ['西安', '厦门', '徐州', '西宁', '襄阳', '咸阳', '湘潭']],
              ['Y', ['银川', '烟台', '扬州', '宜昌', '盐城', '榆林']],
              ['Z', ['郑州', '珠海', '淄博', '株洲', '遵义', '漳州', '湛江']]
            ] %>
            <% cities_data.each do |letter, cities| %>
              <div data-letter-section="<%= letter %>" class="mb-4">
                <div class="text-lg font-bold text-gray-900 mb-2"><%= letter %></div>
                <div class="space-y-1">
                  <% cities.each do |city_name| %>
                    <button 
                      data-action="click->train-city-selector#selectCity"
                      data-city-name="<%= city_name %>"
                      data-city-pinyin="<%= city_name.downcase %>"
                      class="block w-full text-left py-3 px-2 text-sm hover:bg-gray-100 rounded transition-colors">
                      <%= city_name %>
                    </button>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        </div>
        
        <!-- 右侧字母索引栏 -->
        <div class="absolute right-0 top-0 bottom-0 w-5 flex flex-col items-center justify-center py-4 text-[10px] text-gray-500">
          <div class="text-xs mb-1">热门</div>
          <% ('A'..'Z').each do |letter| %>
            <button 
              data-action="click->train-city-selector#jumpToLetter"
              data-letter="<%= letter %>"
              class="text-xs my-0.5 hover:text-gray-900 transition-colors">
              <%= letter %>
            </button>
          <% end %>
        </div>
        
        <!-- 国际标签内容 -->
        <div data-train-city-selector-target="internationalList" class="hidden w-full flex-col overflow-y-auto px-4 py-4">
          <div class="text-center text-gray-400 py-10">
            暂无国际城市数据
          </div>
        </div>
        
      </div>
    </div>
  </div>
</div>
