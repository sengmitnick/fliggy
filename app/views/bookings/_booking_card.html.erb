<div class="bg-surface border border-border rounded-xl overflow-hidden mb-3">
  <!-- Airline Header -->
  <div class="flex items-center justify-between px-4 py-3 border-b border-border">
    <div class="flex items-center space-x-2">
      <div class="w-6 h-6 bg-secondary/10 rounded flex items-center justify-center">
        <svg class="w-4 h-4 text-secondary" fill="currentColor" viewBox="0 0 20 20">
          <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" />
        </svg>
      </div>
      <span class="text-sm font-semibold text-text-primary"><%= booking.flight.airline %>翱翔航服</span>
    </div>
    <div class="flex items-center space-x-2">
      <% if booking.status == 'cancelled' %>
        <span class="px-2 py-1 bg-danger/10 text-danger text-xs rounded">已关闭</span>
      <% elsif booking.status == 'pending' %>
        <span class="px-2 py-1 bg-warning/10 text-warning text-xs rounded">待付款</span>
      <% elsif booking.status == 'paid' %>
        <span class="px-2 py-1 bg-success/10 text-success text-xs rounded">出票成功</span>
      <% elsif booking.status == 'completed' %>
        <span class="px-2 py-1 bg-info/10 text-info text-xs rounded">已完成</span>
      <% end %>
      <button type="button" class="text-text-muted">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Flight Details -->
  <%= link_to booking_path(booking), class: "block" do %>
    <div class="px-4 py-4">
      <!-- Outbound Flight -->
      <div class="flex items-center justify-between mb-2">
        <div class="flex-1">
          <div class="flex items-center space-x-2 mb-1">
            <span class="text-text-primary text-2xl font-bold"><%= booking.flight.departure_city %></span>
            <svg class="w-4 h-4 text-text-muted" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
            </svg>
            <span class="text-text-primary text-2xl font-bold"><%= booking.flight.destination_city %></span>
          </div>
          <div class="text-xs text-text-muted">
            <%= booking.flight.flight_date.strftime('%Y-%m-%d') %>(<%= ['周日', '周一', '周二', '周三', '周四', '周五', '周六'][booking.flight.flight_date.wday] %>) 
            <%= booking.flight.departure_time.strftime('%H:%M') %> 至 <%= booking.flight.arrival_time.strftime('%H:%M') %>
          </div>
        </div>
      </div>

      <!-- Flight Number and Details -->
      <div class="flex items-center space-x-3 text-xs text-text-muted mb-3">
        <span><%= booking.flight.airline %><%= booking.flight.flight_number %></span>
        <span>|</span>
        <span>宝石舱MU2477</span>
        <span>|</span>
        <span>买机舱国际机场T3</span>
        <span>|</span>
        <span>出发</span>
      </div>

      <!-- Services/Tags -->
      <div class="flex flex-wrap gap-2 mb-3">
        <span class="px-2 py-1 bg-surface-elevated text-text-secondary text-xs rounded">已购/做送服务</span>
        <span class="px-2 py-1 bg-surface-elevated text-text-secondary text-xs rounded">保险</span>
        <% if booking.round_trip? %>
          <span class="px-2 py-1 bg-secondary/10 text-secondary text-xs rounded font-semibold">往返机票</span>
        <% end %>
        <span class="px-2 py-1 bg-surface-elevated text-text-secondary text-xs rounded">延误完噪礼包</span>
      </div>

      <% if booking.round_trip? && booking.return_flight %>
        <!-- Return Flight -->
        <div class="border-t border-border pt-3 mt-3">
          <div class="flex items-center justify-between mb-2">
            <div class="flex-1">
              <div class="flex items-center space-x-2 mb-1">
                <span class="text-text-primary text-2xl font-bold"><%= booking.return_flight.departure_city %></span>
                <svg class="w-4 h-4 text-text-muted" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                </svg>
                <span class="text-text-primary text-2xl font-bold"><%= booking.return_flight.destination_city %></span>
              </div>
              <div class="text-xs text-text-muted">
                <%= booking.return_flight.flight_date.strftime('%Y-%m-%d') %>(<%= ['周日', '周一', '周二', '周三', '周四', '周五', '周六'][booking.return_flight.flight_date.wday] %>) 
                <%= booking.return_flight.departure_time.strftime('%H:%M') %> 至 <%= booking.return_flight.arrival_time.strftime('%H:%M') %>
              </div>
            </div>
          </div>

          <div class="flex items-center space-x-3 text-xs text-text-muted">
            <span><%= booking.return_flight.airline %><%= booking.return_flight.flight_number %></span>
            <span>|</span>
            <span>宝石舱国际机场T3</span>
            <span>|</span>
            <span>出发</span>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>

  <!-- Price Section -->
  <div class="px-4 py-3 bg-surface-elevated flex items-center justify-between">
    <div>
      <div class="text-text-muted text-xs mb-1">
        <% if booking.status == 'cancelled' %>
          付付款
        <% else %>
          实付款
        <% end %>
      </div>
      <div class="flex items-baseline space-x-1">
        <span class="text-xs text-text-primary">¥</span>
        <span class="text-2xl font-bold text-primary"><%= sprintf('%.2f', booking.total_price) %></span>
      </div>
    </div>
    <div class="flex items-center space-x-2">
      <% if booking.status == 'paid' || booking.status == 'completed' %>
        <%= button_to '退改签', '#', method: :get, class: 'px-4 py-2 bg-surface border border-border text-text-primary text-sm rounded-full font-medium' %>
        <%= link_to '再来一单', new_booking_path(flight_id: booking.flight_id, trip_type: booking.trip_type, return_flight_id: booking.return_flight_id), class: 'px-4 py-2 bg-primary text-surface text-sm rounded-full font-semibold' %>
      <% elsif booking.status == 'cancelled' %>
        <%= button_to '报销', '#', method: :get, class: 'px-4 py-2 bg-surface border border-border text-text-primary text-sm rounded-full font-medium' %>
      <% elsif booking.status == 'pending' %>
        <%= button_to '取消订单', cancel_booking_path(booking), method: :patch, class: 'px-4 py-2 bg-surface border border-border text-text-primary text-sm rounded-full font-medium', data: { confirm: '确定要取消这个订单吗？' } %>
        <%= link_to '立即支付', booking_path(booking), class: 'px-4 py-2 bg-primary text-surface text-sm rounded-full font-semibold' %>
      <% end %>
    </div>
  </div>
</div>
