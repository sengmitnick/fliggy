<div class="min-h-screen bg-surface">
  <!-- Navigation Bar -->
  <div class="flex justify-between items-center px-4 py-3">
    <%= link_to :back, class: "p-2 -ml-2 text-text-primary" do %>
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M15 18l-6-6 6-6"/>
      </svg>
    <% end %>
    
    <h1 class="text-lg font-bold text-text-primary">选择火车</h1>
    
    <button class="p-2 -mr-2 text-text-primary">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <circle cx="5" cy="12" r="2" />
        <circle cx="12" cy="12" r="2" />
        <circle cx="19" cy="12" r="2" />
      </svg>
    </button>
  </div>

  <!-- Tabs -->
  <div class="flex justify-between px-6 mt-4 mb-6 text-base">
    <div class="text-text-muted font-medium cursor-pointer">我的火车票</div>
    <div class="text-text-primary font-bold relative cursor-pointer flex flex-col items-center">
      按车站
      <div class="absolute -bottom-3 w-8 h-1 bg-[#FFD800] rounded-full"></div>
    </div>
    <div class="text-text-muted font-medium cursor-pointer">按车次</div>
  </div>

  <!-- Search Form -->
  <%= form_with url: select_location_transfers_path, method: :get, local: true, class: "px-6 mt-6" do |f| %>
    
    <!-- Departure/Arrival Station Selection -->
    <div class="flex items-center justify-between pb-4 border-b border-border">
      <div class="text-text-secondary text-lg tracking-wide w-1/3 text-left">
        <%= text_field_tag :departure_station, params[:departure_station], placeholder: '请选择出发站', class: 'w-full border-0 p-0 text-lg focus:ring-0 placeholder-text-muted' %>
      </div>

      <!-- Train Icon (center) -->
      <div class="relative w-12 h-12 flex items-center justify-center cursor-pointer">
        <div class="absolute inset-0 rounded-full border border-blue-100/50 bg-gradient-to-tr from-blue-50/50 to-transparent"></div>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="text-cyan-400">
          <path d="M12 2c-4 0-8 .5-8 4v9.5C4 17.43 5.57 19 7.5 19L6 20.5v.5h2l2-2h4l2 2h2v-.5L16.5 19c1.93 0 3.5-1.57 3.5-3.5V6c0-3.5-4-4-8-4zM7.5 17c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm3.5-7H6V6h5v4zm5.5 7c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-7h-5V6h5v4z"/>
        </svg>
      </div>

      <div class="text-text-secondary text-lg tracking-wide w-1/3 text-right">
        <%= text_field_tag :arrival_station, params[:arrival_station], placeholder: '请选择到达站', class: 'w-full border-0 p-0 text-lg text-right focus:ring-0 placeholder-text-muted' %>
      </div>
    </div>

    <!-- Date Selection -->
    <div class="flex items-center justify-between py-6 border-b border-border cursor-pointer">
      <%= date_field_tag :departure_date, params[:departure_date] || Date.today, class: 'text-text-secondary text-lg tracking-wide flex-1 border-0 p-0 focus:ring-0' %>
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M9 18l6-6-6-6"/>
      </svg>
    </div>

    <!-- Search Button -->
    <%= hidden_field_tag :transfer_type, params[:transfer_type] %>
    <%= hidden_field_tag :service_type, params[:service_type] %>
    <%= f.submit '查询', class: 'w-full bg-[#FFD800] text-text-primary text-lg font-medium py-3 rounded-full mt-10 shadow-sm active:scale-95 transition-transform cursor-pointer' %>

  <% end %>

  <!-- Train List (if searched) -->
  <% if @trains&.any? %>
    <div class="px-4 mt-6">
      <h2 class="text-base font-bold text-text-primary mb-3">搜索结果</h2>
      <div class="space-y-2">
        <% @trains.each do |train| %>
          <%= link_to select_location_transfers_path(
            train_id: train.id,
            transfer_type: params[:transfer_type],
            service_type: params[:service_type]
          ), class: "block bg-surface-elevated rounded-lg p-4 border border-border hover:border-primary transition-colors" do %>
            <div class="flex justify-between items-center">
              <div class="flex-1">
                <div class="font-bold text-text-primary text-lg"><%= train.train_number %></div>
                <div class="text-sm text-text-secondary mt-1">
                  <%= train.departure_city %> → <%= train.arrival_city %>
                </div>
                <div class="text-xs text-text-muted mt-1">
                  <%= train.departure_time&.strftime('%m月%d日 %H:%M') %> - <%= train.arrival_time&.strftime('%H:%M') %>
                </div>
              </div>
              <svg class="w-5 h-5 text-text-muted" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
  <% elsif @trains&.empty? %>
    <div class="px-4 mt-12 text-center">
      <svg class="w-16 h-16 text-text-muted mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <p class="text-text-muted">未找到符合条件的车次</p>
    </div>
  <% end %>
</div>
