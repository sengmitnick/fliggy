<!-- Filter Modal Overlay -->
<div data-bus-ticket-search-target="overlay" class="hidden fixed inset-0 bg-black bg-opacity-60 z-40"></div>

<!-- Filter Modal -->
<div data-bus-ticket-search-target="modal" class="hidden fixed inset-0 z-50 flex items-end justify-center">
  <div class="bg-white w-full max-w-[430px] h-[85vh] rounded-t-2xl flex flex-col">
    <!-- Modal Header -->
    <div class="relative h-14 flex items-center justify-center border-b border-gray-100 flex-shrink-0">
      <h2 class="text-[17px] font-bold text-gray-900">筛选</h2>
      <!-- 关闭按钮 -->
      <button data-action="click->bus-ticket-search#closeModal" class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-500">
        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>

    <!-- Modal Content -->
    <div class="flex flex-1 overflow-hidden">
      <!-- Left Sidebar - Filter Categories -->
      <div class="w-[90px] bg-[#F7F8FA] overflow-y-auto no-scrollbar flex-shrink-0">
        <button data-bus-ticket-search-target="departureTimeTab" data-tab="departureTime" data-action="click->bus-ticket-search#selectTab" class="w-full py-4 px-3 text-[13px] font-medium text-gray-900 bg-white border-l-4 border-[#FFD900] text-left">
          发车时段
        </button>
        <button data-bus-ticket-search-target="seatTypeTab" data-tab="seatType" data-action="click->bus-ticket-search#selectTab" class="w-full py-4 px-3 text-[13px] text-gray-600 border-l-4 border-transparent text-left">
          座位类型
        </button>
        <button data-bus-ticket-search-target="departureStationTab" data-tab="departureStation" data-action="click->bus-ticket-search#selectTab" class="w-full py-4 px-3 text-[13px] text-gray-600 border-l-4 border-transparent text-left">
          出发车站
        </button>
        <button data-bus-ticket-search-target="arrivalStationTab" data-tab="arrivalStation" data-action="click->bus-ticket-search#selectTab" class="w-full py-4 px-3 text-[13px] text-gray-600 border-l-4 border-transparent text-left">
          到达车站
        </button>
      </div>

      <!-- Right Content - Filter Options -->
      <div class="flex-1 bg-white overflow-y-auto no-scrollbar p-4 pb-24">
        <!-- Departure Time Section -->
        <div data-bus-ticket-search-target="departureTimeSection">
          <h3 class="text-[15px] font-bold mb-3 text-gray-900">发车时段</h3>
          <div class="space-y-2">
            <% [
              { value: 'early', label: '凌晨 00:00-05:59', time_range: '00:00-05:59' },
              { value: 'morning', label: '上午 06:00-11:59', time_range: '06:00-11:59' },
              { value: 'afternoon', label: '下午 12:00-17:59', time_range: '12:00-17:59' },
              { value: 'evening', label: '晚上 18:00-23:59', time_range: '18:00-23:59' }
            ].each do |period| %>
              <div 
                data-action="click->bus-ticket-search#toggleTimeSlot" 
                data-value="<%= period[:value] %>" 
                data-bus-ticket-search-target="timeSlot"
                class="bg-[#F7F8FA] text-gray-900 rounded px-3 py-3 text-[13px] cursor-pointer hover:bg-gray-200 transition-colors">
                <%= period[:label] %>
              </div>
            <% end %>
          </div>
        </div>

        <!-- Seat Type Section -->
        <div data-bus-ticket-search-target="seatTypeSection" class="hidden">
          <h3 class="text-[15px] font-bold mb-3 text-gray-900">座位类型</h3>
          <div class="flex flex-wrap gap-2">
            <% ['普通座', '商务座', '豪华座'].each do |seat_type| %>
              <div 
                data-action="click->bus-ticket-search#toggleSeatType" 
                data-value="<%= seat_type %>" 
                data-bus-ticket-search-target="seatType"
                class="bg-[#F7F8FA] text-gray-900 rounded px-4 py-2 text-[13px] min-w-[70px] text-center cursor-pointer hover:bg-gray-200 transition-colors">
                <%= seat_type %>
              </div>
            <% end %>
          </div>
        </div>

        <!-- Departure Station Section -->
        <div data-bus-ticket-search-target="departureStationSection" class="hidden">
          <h3 class="text-[15px] font-bold mb-3 text-gray-900">出发车站</h3>
          <div class="space-y-2">
            <% @departure_stations&.each do |station| %>
              <div 
                data-action="click->bus-ticket-search#toggleDepartureStation" 
                data-value="<%= station %>" 
                data-bus-ticket-search-target="departureStation"
                class="bg-[#F7F8FA] text-gray-900 rounded px-3 py-3 text-[13px] cursor-pointer hover:bg-gray-200 transition-colors">
                <%= station %>
              </div>
            <% end %>
          </div>
        </div>

        <!-- Arrival Station Section -->
        <div data-bus-ticket-search-target="arrivalStationSection" class="hidden">
          <h3 class="text-[15px] font-bold mb-3 text-gray-900">到达车站</h3>
          <div class="space-y-2">
            <% @arrival_stations&.each do |station| %>
              <div 
                data-action="click->bus-ticket-search#toggleArrivalStation" 
                data-value="<%= station %>" 
                data-bus-ticket-search-target="arrivalStation"
                class="bg-[#F7F8FA] text-gray-900 rounded px-3 py-3 text-[13px] cursor-pointer hover:bg-gray-200 transition-colors">
                <%= station %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- Bottom Action Buttons -->
    <div class="h-auto bg-white border-t border-gray-100 p-3 flex gap-3 flex-shrink-0 pb-8">
      <button 
        data-action="click->bus-ticket-search#resetFilters" 
        class="flex-1 bg-[#F5F6F8] text-gray-600 rounded-full h-11 text-[15px] font-medium hover:bg-gray-300 transition-colors">
        重置
      </button>
      <button 
        data-action="click->bus-ticket-search#applyFilters" 
        data-bus-ticket-search-target="applyButton"
        class="flex-[2] bg-[#FFD900] text-[#111111] rounded-full h-11 text-[15px] font-medium shadow-sm hover:bg-[#ffd000] transition-colors">
        查看结果
      </button>
    </div>
  </div>
</div>

<style>
  /* 自定义滚动条隐藏 */
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
</style>
