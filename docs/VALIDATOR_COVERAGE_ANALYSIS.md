# 验证器用例覆盖分析报告

## 概览

目前系统共有 **68个验证器用例** (v001-v068)，用于测试 AI Agent 在旅游平台的各种操作能力。

---

## 已有验证器覆盖的模块

### 1. 🏨 酒店预订模块 (Hotel Booking)
**用例数量**: 6个  
**覆盖场景**:
- v001: 预订经济型酒店（预算考虑）
- v015: 搜索高评分酒店
- v017: 预订上海任意酒店
- v018: 预订北京高评分酒店
- v019: 预订广州经济酒店
- v020: 预订深圳酒店（两晚）
- v021: 预订杭州商务酒店

**已覆盖**: ✅ 完整覆盖（搜索、预订、多种条件筛选）

---

### 2. 🚄 火车票预订模块 (Train Booking)
**用例数量**: 7个  
**覆盖场景**:
- v002: 预订最早班次火车票
- v007: 预订日本早班火车票（境外）
- v011: 搜索最便宜座位
- v012: 搜索欧洲最便宜火车票
- v022-v026: 5个城际火车票预订（北京↔上海↔深圳↔广州↔杭州）

**已覆盖**: ✅ 完整覆盖（国内+境外、搜索+预订、价格对比）

---

### 3. ✈️ 机票预订模块 (Flight Booking)
**用例数量**: 6个  
**覆盖场景**:
- v003: 预订航班
- v010: 搜索最便宜航班
- v027-v031: 5个城际航班预订（上海↔深圳↔北京↔杭州↔广州）

**已覆盖**: ✅ 完整覆盖（搜索、预订、价格对比、时间筛选）

---

### 4. 🚗 租车服务模块 (Car Rental)
**用例数量**: 6个  
**覆盖场景**:
- v005: 预订经济型租车
- v013: 搜索家庭车型
- v032: 上海租车（任意车型）
- v033: 北京租SUV
- v034: 深圳租最便宜的车
- v035: 广州租豪华车
- v036: 杭州租商务车

**已覆盖**: ✅ 完整覆盖（多车型、多城市、价格对比）

---

### 5. 🚌 汽车票预订模块 (Bus Ticket)
**用例数量**: 6个  
**覆盖场景**:
- v006: 预订早班汽车票
- v014: 搜索最快汽车线路
- v042-v046: 5个城际汽车票预订（广州↔深圳、上海↔杭州、北京→天津）

**已覆盖**: ✅ 完整覆盖（多线路、时间筛选、速度对比）

---

### 6. 🎫 景点门票模块 (Attraction Tickets)
**用例数量**: 1个  
**覆盖场景**:
- v047: 预订深圳欢乐港湾成人票（对比供应商价格）

**已覆盖**: ⚠️ 基础覆盖（仅1个用例）

---

### 7. 🌍 跟团游模块 (Tour Groups)
**用例数量**: 6个  
**覆盖场景**:
- v004: 预订旅游套餐
- v009: 搜索经济型旅游
- v037-v041: 5个城市跟团游预订（上海、北京、三亚、广州、杭州）

**已覆盖**: ✅ 完整覆盖（多城市、搜索+预订）

---

### 8. 🏨 酒店套餐模块 (Hotel Packages)
**用例数量**: 1个  
**覆盏场景**:
- v048: 预订酒店套餐

**已覆盖**: ⚠️ 基础覆盖（仅1个用例）

---

### 9. 📝 签证服务模块 (Visa Services)
**用例数量**: 1个  
**覆盖场景**:
- v049: 申请签证服务

**已覆盖**: ⚠️ 基础覆盖（仅1个用例）

---

### 10. 🛡️ 旅游保险模块 (Travel Insurance)
**用例数量**: 1个  
**覆盖场景**:
- v050: 购买成都出行境内旅游保险（差异化定价、7天、最便宜）

**已覆盖**: ⚠️ 基础覆盖（仅1个用例，但覆盖了差异化定价核心逻辑）

---

### 11. 🚖 接送机服务模块 (Transfer Services)
**用例数量**: 1个  
**覆盖场景**:
- v051: 预订虹桥机场接机送到上海火车站（北京→上海航班，最便宜套餐）

**已覆盖**: ⚠️ 基础覆盖（仅1个用例）

---

### 12. 📶 境外上网服务模块 (Internet Services)
**用例数量**: 17个  
**覆盖场景**:

#### WiFi租赁 (6个):
- v052: 预订境外WiFi（通用场景）
- v059: 泰国WiFi 3天
- v060: 日本WiFi 7天
- v061: 韩国5G WiFi
- v062: 欧洲WiFi 10天
- v063: 美国5G WiFi

#### 电话卡 (6个):
- v008: 日本电话卡（早期通用场景）
- v054: 日本电话卡 5天
- v055: 韩国电话卡 3天
- v056: 泰国电话卡 5天
- v057: 新加坡电话卡 7天
- v058: 美国电话卡 7天

#### 流量包 (5个):
- v053: 购买流量包（通用场景）
- v064: 日本流量包 3天
- v065: 韩国流量包 7天
- v066: 泰国流量包 1天
- v067: 新加坡流量包 3天
- v068: 马来西亚流量包 7天

**已覆盖**: ✅ 完整覆盖（三种上网方式、多国家、多时长）

---

### 13. 🧘 深度旅行模块 (Deep Travel)
**用例数量**: 1个  
**覆盖场景**:
- v016: 预订深度旅行导览服务

**已覆盖**: ⚠️ 基础覆盖（仅1个用例）

---

## 首页模块对照分析

根据 `app/views/home/index.html.erb` 的首页服务网格，项目共展示 **35个服务入口**：

### 第一页服务网格 (15个):

#### 第一行 (5个大图标):
1. ✅ **酒店** → 已覆盖 (7个用例)
2. ✅ **机票** → 已覆盖 (6个用例)
3. ✅ **火车票** → 已覆盖 (7个用例)
4. ✅ **租车** → 已覆盖 (6个用例)
5. ✅ **旅游** → 已覆盖 (6个跟团游用例)

#### 第二行 (5个小图标):
6. ❌ **民宿/公寓** → 未覆盖
7. ✅ **接送机** → 已覆盖 (1个用例)
8. ✅ **跟团游** → 已覆盖 (6个用例)
9. ✅ **汽车票** → 已覆盖 (6个用例)
10. ✅ **门票** → 已覆盖 (1个用例)

#### 第三行 (5个小图标):
11. ✅ **酒店套餐** → 已覆盖 (1个用例)
12. ✅ **保险服务** → 已覆盖 (1个用例)
13. ❌ **借钱/分期** → 未覆盖（金融服务）
14. ✅ **出境游/签证** → 已覆盖 (1个签证用例)
15. ❌ **里程签到** → 未覆盖（会员功能）

### 第二页服务网格 (20个):

#### 第一行 (5个):
16. ❌ **国际酒店** → 未覆盖
17. ✅ **签证** → 已覆盖 (1个用例)
18. ✅ **境外上网** → 已覆盖 (17个用例！)
19. ❌ **旅行购物** → 未覆盖
20. ❌ **境外当地交通** → 未覆盖

#### 第二行 (5个):
21. ❌ **邮轮** → 未覆盖
22. ✅ **深度游+** → 已覆盖 (1个用例)
23. ❌ **包车** → 未覆盖
24. ❌ **路线宝箱** → 未覆盖
25. ❌ **打车** → 未覆盖

#### 第三行 (5个):
26. ❌ **政府补贴** → 未覆盖
27. ❌ **阿里商旅** → 未覆盖
28. ❌ **省钱卡** → 未覆盖
29. ❌ **能量红包** → 未覆盖
30. ❌ **会员商城** → 未覆盖

### 特殊促销卡片 (4个):
31. ❌ **天天特惠** → 未覆盖
32. ❌ **特价机票** → 未覆盖（活动页面）
33. ❌ **榜单** → 未覆盖
34. ❌ **演出·赛事** → 未覆盖
35. ❌ **爆款直播** → 未覆盖

---

## 已有用例的模块 (13个)

| 模块 | 用例数 | 覆盖度 |
|-----|-------|--------|
| 🏨 酒店预订 | 7 | ✅ 完整 |
| 🚄 火车票 | 7 | ✅ 完整 |
| ✈️ 机票 | 6 | ✅ 完整 |
| 🚗 租车 | 6 | ✅ 完整 |
| 🚌 汽车票 | 6 | ✅ 完整 |
| 🌍 跟团游 | 6 | ✅ 完整 |
| 📶 境外上网 | 17 | ✅ 完整 |
| 🎫 景点门票 | 1 | ⚠️ 基础 |
| 🏨 酒店套餐 | 1 | ⚠️ 基础 |
| 📝 签证服务 | 1 | ⚠️ 基础 |
| 🛡️ 旅游保险 | 1 | ⚠️ 基础 |
| 🚖 接送机 | 1 | ⚠️ 基础 |
| 🧘 深度旅行 | 1 | ⚠️ 基础 |

**总计**: 13个模块，60个用例

---

## 还没有用例的模块 (22个)

### 核心交通/住宿类 (2个):
1. ❌ **民宿/公寓** (Homestays) - 首页第一页第二行
2. ❌ **国际酒店** (International Hotels) - 首页第二页第一行

### 境外旅游类 (2个):
3. ❌ **旅行购物** (Abroad Shopping) - 首页第二页第一行
4. ❌ **境外当地交通** (Abroad Tickets) - 首页第二页第一行

### 特色旅游类 (3个):
5. ❌ **邮轮** (Cruises) - 首页第二页第二行
6. ❌ **包车** (Chartered Tours) - 首页第二页第二行
7. ❌ **路线宝箱** (Route Treasure) - 首页第二页第二行

### 本地出行类 (1个):
8. ❌ **打车** (Taxi/Ride-hailing) - 首页第二页第二行

### 营销活动类 (6个):
9. ❌ **天天特惠** (Daily Deals) - 促销卡片
10. ❌ **特价机票** (Special Flights) - 促销卡片
11. ❌ **榜单** (Rankings) - 促销卡片
12. ❌ **演出·赛事** (Events/Shows) - 促销卡片
13. ❌ **爆款直播** (Live Streaming) - 促销卡片
14. ❌ **政府补贴** (Government Subsidies) - 首页第二页第三行

### 金融/会员类 (5个):
15. ❌ **借钱/分期** (Loan/Installment) - 首页第一页第三行
16. ❌ **里程签到** (Mileage Check-in) - 首页第一页第三行
17. ❌ **阿里商旅** (Alibaba Travel) - 首页第二页第三行
18. ❌ **省钱卡** (Savings Card) - 首页第二页第三行
19. ❌ **能量红包** (Energy Red Packet) - 首页第二页第三行
20. ❌ **会员商城** (Membership Mall) - 首页第二页第三行

### 其他信息类 (3个):
21. ❌ **问一问** (Ask/FAQ) - 顶部导航
22. ❌ **推荐** (Recommendations) - 顶部导航
23. ❌ **我的收藏** (My Favorites) - 购物车图标位置

---

## 关键发现

### ✅ 优势领域:
1. **核心交通预订** 完整覆盖：酒店、机票、火车票、租车、汽车票
2. **境外上网服务** 覆盖最全：17个用例，覆盖WiFi/电话卡/流量包三种方式
3. **跟团游** 覆盖充分：6个城市场景

### ⚠️ 需要扩充的模块:
1. **景点门票** (仅1个用例) - 建议增加：
   - 不同城市景点
   - 儿童票/老人票场景
   - 多景点套票
   
2. **酒店套餐** (仅1个用例) - 建议增加：
   - 不同套餐类型
   - 亲子套餐、蜜月套餐

3. **签证服务** (仅1个用例) - 建议增加：
   - 不同国家签证
   - 团队签证、家庭签证

4. **旅游保险** (仅1个用例) - 建议增加：
   - 境外旅游保险
   - 老人/儿童专项保险

5. **接送机服务** (仅1个用例) - 建议增加：
   - 送机场景
   - 火车站接送
   - 多人拼车

6. **深度旅行** (仅1个用例) - 建议增加：
   - 不同场馆类型
   - 不同导览服务

### ❌ 完全缺失的重要模块:
1. **民宿/公寓** - 重要住宿类型，应该补充
2. **邮轮** - 特色旅游产品，有完整数据包支持
3. **包车游** - 有数据支持（`chartered_tours`），应该补充
4. **境外当地交通** - 有数据包 `abroad_tickets.rb`，应该补充
5. **旅行购物** - 有数据包 `abroad_shopping.rb`，应该补充

### 💡 可延后的模块:
- 金融类服务（借钱/分期、省钱卡）
- 会员营销类（里程签到、能量红包、会员商城）
- 活动页面（天天特惠、榜单、特价机票）
- 第三方集成（阿里商旅）
- 社交功能（直播、问一问、推荐）

---

## 建议优先级

### 🔥 P0 - 立即补充 (5个核心模块):
1. **民宿/公寓** - 首页核心服务，缺失明显
2. **邮轮** - 有完整数据包支持
3. **包车游** - 有数据包 `chartered_tours.rb`
4. **境外当地交通** - 有数据包 `abroad_tickets.rb`
5. **旅行购物** - 有数据包 `abroad_shopping.rb`

### ⚡ P1 - 近期扩充 (6个模块的深度用例):
1. 景点门票扩展（+5个用例）
2. 酒店套餐扩展（+3个用例）
3. 签证服务扩展（+4个用例）
4. 旅游保险扩展（+3个用例）
5. 接送机服务扩展（+3个用例）
6. 深度旅行扩展（+3个用例）

### 📅 P2 - 长期规划:
- 营销活动类验证器
- 金融服务类验证器
- 社交功能类验证器

---

## 数据包支持情况

根据 `app/validators/support/data_packs/v1/` 目录，以下数据包有完整支持但**尚未开发验证器**:

1. ✅ `cruises.rb` - 邮轮数据 → **应该开发验证器**
2. ✅ `chartered_tours.rb` - 包车游数据 → **应该开发验证器**
3. ✅ `abroad_shopping.rb` - 境外购物数据 → **应该开发验证器**
4. ✅ `abroad_tickets.rb` - 境外交通数据 → **应该开发验证器**
5. ✅ `live_products.rb` - 直播产品数据 → 低优先级
6. ✅ `membership_products.rb` - 会员商品数据 → 低优先级

---

## 总结

- **总用例数**: 68个
- **覆盖模块数**: 13个
- **覆盖率**: 37% (13/35个首页服务)
- **核心交通/住宿覆盖**: 90% (9/10个)
- **特色旅游覆盖**: 30% (3/10个)
- **营销/会员覆盖**: 0% (0/10个)

**建议**: 优先补充5个有数据包支持的核心模块，然后扩充现有6个基础模块的深度用例，最终达到20+模块、100+用例的覆盖规模。
